<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ’ä¸°è´¢åŠ¡ Pro - 15.0 ç»ˆæç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <style>
        :root { 
            --ios-blue: #007AFF; --ios-green: #34C759; --ios-red: #FF3B30; --ios-orange: #FF9500;
            --bg: #F2F2F7; --card: #FFFFFF; --text-p: #1C1C1E; --text-s: #8E8E93;
        }
        body { background: var(--bg); color: var(--text-p); font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 0; padding-bottom: 110px; -webkit-font-smoothing: antialiased; }

        /* é¡¶éƒ¨æ§åˆ¶ä¸­å¿ƒï¼šæ•´åˆæ—¥æœŸé€‰æ‹© */
        .control-center { padding: 50px 20px 25px; background: #1C1C1E; color: #fff; border-bottom-right-radius: 32px; border-bottom-left-radius: 32px; position: sticky; top: -30px; z-index: 1100; box-shadow: 0 4px 20px rgba(0,0,0,0.2); }
        .net-value { font-size: 36px; font-weight: 800; margin: 10px 0; font-family: 'SF Mono', monospace; color: white; }
        .date-picker-row { display: flex; gap: 10px; margin-top: 15px; background: rgba(255,255,255,0.1); padding: 10px; border-radius: 14px; }
        .date-input-group { flex: 1; display: flex; flex-direction: column; }
        .date-input-group label { font-size: 10px; color: rgba(255,255,255,0.5); margin-bottom: 2px; font-weight: 600; }
        .date-input-group input { background: transparent; border: none; color: white; font-size: 13px; font-weight: 600; outline: none; width: 100%; }

        /* å±€éƒ¨çœ‹æ¿ */
        .sub-stat-bar { background: var(--card); margin: -15px 20px 20px; padding: 20px; border-radius: 24px; box-shadow: 0 8px 25px rgba(0,0,0,0.06); display: flex; justify-content: space-between; border: 0.5px solid rgba(0,0,0,0.05); }
        .stat-item { text-align: center; flex: 1; }
        .stat-label { font-size: 11px; color: var(--text-s); margin-bottom: 4px; display: block; font-weight: 600; }
        .stat-val { font-size: 15px; font-weight: 700; color: var(--text-p); }

        /* æ¨¡å—ä¸åˆ—è¡¨ */
        .section-card { background: var(--card); border-radius: 24px; margin: 0 20px 15px; padding: 22px; border: 0.5px solid rgba(0,0,0,0.05); }
        .section-title { font-size: 17px; font-weight: 700; margin-bottom: 15px; display: flex; justify-content: space-between; }
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .grid-box { background: var(--bg); padding: 12px 8px; border-radius: 14px; text-align: center; }
        .grid-box b { font-size: 12px; display: block; margin-top: 4px; color: var(--text-p); }

        .list-container { margin: 0 20px; border-radius: 24px; overflow: hidden; background: #fff; }
        .ios-item { background: var(--card); padding: 18px 20px; border-bottom: 0.5px solid #F2F2F7; display: flex; justify-content: space-between; align-items: center; }
        .ios-item:active { background: #F5F5F7; }

        /* è¯¦æƒ…å¼¹çª— */
        .sheet { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 2000; display: none; backdrop-filter: blur(10px); }
        .sheet-content { position: absolute; bottom: 0; width: 100%; height: 90%; background: var(--bg); border-top-left-radius: 35px; border-top-right-radius: 35px; padding: 25px; box-sizing: border-box; overflow-y: auto; }
        .btn { border: none; border-radius: 16px; padding: 16px; font-weight: 700; width: 100%; margin-bottom: 12px; font-size: 16px; }
        .btn-p { background: var(--ios-blue); color: #fff; }
        .btn-s { background: #fff; color: var(--text-p); border: 0.5px solid #DDD; }
        .btn-danger { background: none; color: var(--ios-red); font-size: 13px; margin-top: 5px; border: none; }

        /* å¯¼èˆª */
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 85px; background: rgba(255,255,255,0.9); backdrop-filter: blur(20px); display: flex; border-top: 0.5px solid #DDD; z-index: 1000; padding-bottom: env(safe-area-inset-bottom); }
        .nav-link { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #999; font-size: 10px; font-weight: 700; text-decoration: none; }
        .nav-link.active { color: var(--ios-blue); }
        .nav-link i { font-size: 22px; margin-bottom: 4px; font-style: normal; }

        .page { display: none; } .page.active { display: block; }
        #login-screen { position: fixed; inset: 0; background: #fff; z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 40px; }
    </style>
</head>
<body>

<div id="login-screen">
    <div style="width: 100%; max-width: 300px; text-align: center;">
        <h1 style="font-size: 30px; font-weight: 800; margin-bottom: 40px;">æ’ä¸°è´¢åŠ¡äº‘</h1>
        <input type="email" id="email" placeholder="é‚®ç®±" style="width:100%; padding:16px; margin-bottom:12px; border:1px solid #EEE; border-radius:14px; outline:none;">
        <input type="password" id="pw" placeholder="å¯†ç " style="width:100%; padding:16px; margin-bottom:25px; border:1px solid #EEE; border-radius:14px; outline:none;">
        <button onclick="handleLogin()" class="btn btn-p">è¿›å…¥ç³»ç»Ÿ</button>
    </div>
</div>

<div id="app" style="display:none;">
    <header class="control-center">
        <div style="display:flex; justify-content:space-between; opacity:0.5; font-size:11px; font-weight:700; letter-spacing:1px;"><span>MANAGEMENT CENTER</span><span onclick="load()">åˆ·æ–°æ•°æ®</span></div>
        <div class="net-value" id="h-net">Â¥ 0.00</div>
        <div class="date-picker-row">
            <div class="date-input-group">
                <label>å¼€å§‹æ—¥æœŸ</label>
                <input type="date" id="s-date" onchange="renderAll()">
            </div>
            <div style="color:rgba(255,255,255,0.3); align-self:center; font-weight:800;">TO</div>
            <div class="date-input-group">
                <label>ç»“æŸæ—¥æœŸ</label>
                <input type="date" id="e-date" onchange="renderAll()">
            </div>
        </div>
    </header>

    <section id="home" class="page active" style="margin-top:20px;">
        <div class="section-card" onclick="tab('income',document.getElementById('n-i'))">
            <div class="section-title">ğŸ’° å®¢æˆ·ä¸šåŠ¡ <span>ã€‰</span></div>
            <div class="grid-3">
                <div class="grid-box"><span class="stat-label">å‘¨æœŸåº”æ”¶</span><b id="h-i-t">Â¥0</b></div>
                <div class="grid-box"><span class="stat-label">å·²æ”¶</span><b id="h-i-p" style="color:var(--ios-green)">Â¥0</b></div>
                <div class="grid-box"><span class="stat-label">å¾…æ”¶ä½™é¢</span><b id="h-i-d" style="color:var(--ios-red)">Â¥0</b></div>
            </div>
        </div>
        <div class="section-card" onclick="tab('vendor',document.getElementById('n-v'))">
            <div class="section-title">ğŸ“‰ ä¾›åº”å•†æ”¯å‡º <span>ã€‰</span></div>
            <div class="grid-3">
                <div class="grid-box"><span class="stat-label">å‘¨æœŸåº”ä»˜</span><b id="h-v-t">Â¥0</b></div>
                <div class="grid-box"><span class="stat-label">å·²ä»˜</span><b id="h-v-p" style="color:var(--ios-green)">Â¥0</b></div>
                <div class="grid-box"><span class="stat-label">å¾…ä»˜ä½™é¢</span><b id="h-v-d" style="color:var(--ios-red)">Â¥0</b></div>
            </div>
        </div>
        <div class="section-card" onclick="tab('worker',document.getElementById('n-w'))">
            <div class="section-title">ğŸ‘· åŠ³åŠ¡å·¥äºº <span>ã€‰</span></div>
            <div class="grid-3">
                <div class="grid-box"><span class="stat-label">æ€»è®¡æˆæœ¬</span><b id="h-w-t">Â¥0</b></div>
                <div class="grid-box"><span class="stat-label">å·²å‘æ”¾</span><b id="h-w-p" style="color:var(--ios-green)">Â¥0</b></div>
                <div class="grid-box"><span class="stat-label">æ¬ å‘ä½™é¢</span><b id="h-w-d" style="color:var(--ios-red)">Â¥0</b></div>
            </div>
        </div>
        <div style="padding: 0 20px;"><button class="btn btn-s" onclick="document.getElementById('xl-up').click()">åŒæ­¥æ•°ç”µå‘ç¥¨ Excel</button></div>
        <input type="file" id="xl-up" hidden onchange="handleExcel(this)">
    </section>

    <section id="income" class="page">
        <div class="sub-stat-bar">
            <div class="stat-item"><span class="stat-label">æ€»åº”æ”¶</span><div class="stat-val" id="si-t">0</div></div>
            <div class="stat-item"><span class="stat-label">å·²æ”¶</span><div class="stat-val" id="si-p">0</div></div>
            <div class="stat-item"><span class="stat-label">å¾…æ”¶</span><div class="stat-val" id="si-d" style="color:var(--ios-red)">0</div></div>
        </div>
        <div style="padding: 0 20px; margin-bottom: 15px;"><button class="btn btn-p" onclick="addEntity('client_name','invoices')">+ æ–°å¢å®¢æˆ·</button></div>
        <div id="list-income" class="list-container"></div>
    </section>

    <section id="vendor" class="page">
        <div class="sub-stat-bar">
            <div class="stat-item"><span class="stat-label">æ€»åº”ä»˜</span><div class="stat-val" id="sv-t">0</div></div>
            <div class="stat-item"><span class="stat-label">å·²ä»˜</span><div class="stat-val" id="sv-p">0</div></div>
            <div class="stat-item"><span class="stat-label">å¾…ä»˜</span><div class="stat-val" id="sv-d" style="color:var(--ios-red)">0</div></div>
        </div>
        <div style="padding: 0 20px; margin-bottom: 15px;"><button class="btn btn-p" onclick="addEntity('vendor_name','vendor_invoices')">+ æ–°å¢ä¾›åº”å•†</button></div>
        <div id="list-vendor" class="list-container"></div>
    </section>

    <section id="worker" class="page">
        <div class="sub-stat-bar">
            <div class="stat-item"><span class="stat-label">æ€»æˆæœ¬</span><div class="stat-val" id="sw-t">0</div></div>
            <div class="stat-item"><span class="stat-label">å·²å‘</span><div class="stat-val" id="sw-p">0</div></div>
            <div class="stat-item"><span class="stat-label">æ¬ æ¬¾</span><div class="stat-val" id="sw-d" style="color:var(--ios-red)">0</div></div>
        </div>
        <div style="padding: 0 20px; margin-bottom: 15px;"><button class="btn btn-p" onclick="addW()">+ æ–°å¢å·¥äºº</button></div>
        <div id="list-worker" class="list-container"></div>
    </section>

    <div id="sheet" class="sheet" onclick="if(event.target===this)this.style.display='none'">
        <div class="sheet-content" onclick="event.stopPropagation()">
            <div id="sheet-head"></div>
            <div id="sheet-body"></div>
        </div>
    </div>

    <nav class="nav-bar">
        <a class="nav-link active" onclick="tab('home',this)"><i>ğŸ </i>æ€»è§ˆ</a>
        <a class="nav-link" id="n-i" onclick="tab('income',this)"><i>ğŸ’°</i>å®¢æˆ·</a>
        <a class="nav-link" id="n-v" onclick="tab('vendor',this)"><i>ğŸ“‰</i>è´¦å•</a>
        <a class="nav-link" id="n-w" onclick="tab('worker',this)"><i>ğŸ‘·</i>åŠ³åŠ¡</a>
    </nav>
</div>

<script>
    const S_URL = "https://vjelnswcmypvypegqxrb.supabase.co";
    const S_KEY = "sb_publishable_BUhR8WlHyaOHnK5IjEGKtw_lcre2gFT";
    const sb = supabase.createClient(S_URL, S_KEY);
    let db = { invs:[], vInvs:[], pays:[], vPays:[], workers:[], logs:[] };

    // æ—¥æœŸè¿‡æ»¤æ ¸å¿ƒé€»è¾‘
    function getFiltered(list, key) {
        const s = document.getElementById('s-date').value;
        const e = document.getElementById('e-date').value;
        if(!s && !e) return list;
        const start = s ? new Date(s) : new Date('1970-01-01');
        const end = e ? new Date(e) : new Date('2099-12-31');
        end.setHours(23,59,59);
        return list.filter(item => {
            const d = new Date(item[key] || item.log_date || item.inv_date || item.pay_date);
            return d >= start && d <= end;
        });
    }

    async function handleLogin() {
        const { error } = await sb.auth.signInWithPassword({ email:document.getElementById('email').value, password:document.getElementById('pw').value });
        if(error) alert(error.message); else checkSession();
    }
    async function checkSession() {
        const { data:{session} } = await sb.auth.getSession();
        if(session) { document.getElementById('login-screen').style.display='none'; document.getElementById('app').style.display='block'; load(); }
    }
    window.onload = checkSession;

    async function load() {
        const f = async (t) => (await sb.from(t).select('*')).data || [];
        db.invs = await f('invoices'); db.pays = await f('payments');
        db.vInvs = await f('vendor_invoices'); db.vPays = await f('vendor_payments');
        db.workers = await f('workers'); db.logs = await f('wage_logs');
        renderAll();
    }

    function fmt(n) { return 'Â¥' + (n||0).toLocaleString(undefined, {minimumFractionDigits:0}); }

    function renderAll() {
        // å…¨å±€åº”ç”¨è¿‡æ»¤
        const fI = getFiltered(db.invs, 'inv_date'), fP = getFiltered(db.pays, 'pay_date');
        const fVI = getFiltered(db.vInvs, 'inv_date'), fVP = getFiltered(db.vPays, 'pay_date');
        const fL = getFiltered(db.logs, 'log_date');

        const it = fI.reduce((s,i)=>s+i.amount,0), ip = fP.reduce((s,i)=>s+i.amount,0);
        const vt = fVI.reduce((s,i)=>s+i.amount,0), vp = fVP.reduce((s,i)=>s+i.amount,0);
        const wt = fL.filter(l=>['å·¥æ—¶','å¥–é‡‘','åˆ†çº¢'].includes(l.type)).reduce((s,l)=>s+l.amount,0);
        const wp = fL.filter(l=>l.type==='å‘å·¥èµ„').reduce((s,l)=>s+l.amount,0);

        // æ›´æ–° UI æ•°å­—
        const update = (pre, t, p) => {
            document.getElementById(`h-${pre}-t`).innerText = fmt(t);
            document.getElementById(`h-${pre}-p`).innerText = fmt(p);
            document.getElementById(`h-${pre}-d`).innerText = fmt(t - p);
            if(document.getElementById(`s${pre}-t`)) {
                document.getElementById(`s${pre}-t`).innerText = fmt(t);
                document.getElementById(`s${pre}-p`).innerText = fmt(p);
                document.getElementById(`s${pre}-d`).innerText = fmt(t - p);
            }
        };
        update('i', it, ip); update('v', vt, vp); update('w', wt, wp);
        document.getElementById('h-net').innerText = fmt(it - vt - wt);

        // æ¸²æŸ“åˆ—è¡¨ + æ’åºï¼ˆæ¬ æ¬¾ä»å¤šåˆ°å°‘ï¼‰
        renderList('list-income', db.invs, db.pays, 'client_name', 'invoices', 'payments', fI, fP);
        renderList('list-vendor', db.vInvs, db.vPays, 'vendor_name', 'vendor_invoices', 'vendor_payments', fVI, fVP);
        renderWList(fL);
    }

    function renderList(elId, rawInvs, rawPays, key, t1, t2, fI, fP) {
        const el = document.getElementById(elId); el.innerHTML = '';
        const names = [...new Set([...rawInvs.map(i=>i[key]), ...rawPays.map(p=>p[key])])].filter(Boolean);
        
        const sorted = names.map(n => {
            const total = fI.filter(i=>i[key]===n).reduce((s,i)=>s+i.amount,0);
            const paid = fP.filter(p=>p[key]===n).reduce((s,p)=>s+p.amount,0);
            return { n, diff: total - paid };
        }).sort((a,b) => Math.abs(b.diff) - Math.abs(a.diff));

        sorted.forEach(item => {
            if(item.diff === 0 && document.getElementById('s-date').value) return; // æœç´¢æ¨¡å¼ä¸‹éšè—ç»“æ¸…é¡¹
            el.innerHTML += `<div class="ios-item" onclick="showDetail('${item.n}','${key}','${t1}','${t2}')">
                <b>${item.n}</b><span style="font-family:'SF Mono'; font-weight:700; color:${item.diff>0?'var(--ios-red)':'var(--ios-green)'}">${fmt(item.diff)}</span>
            </div>`;
        });
    }

    function renderWList(fL) {
        const el = document.getElementById('list-worker'); el.innerHTML = '';
        const sorted = db.workers.map(w => {
            const earned = fL.filter(l=>l.worker_name===w.name && l.type!=='å‘å·¥èµ„').reduce((s,l)=>s+l.amount,0);
            const taken = fL.filter(l=>l.worker_name===w.name && l.type==='å‘å·¥èµ„').reduce((s,l)=>s+l.amount,0);
            return { w, diff: earned - taken };
        }).sort((a,b) => b.diff - a.diff);

        sorted.forEach(item => {
            el.innerHTML += `<div class="ios-item" onclick="showWDetail('${item.w.name}',${item.w.hourly_rate})">
                <b>${item.w.name}</b><span style="font-family:'SF Mono'; font-weight:700; color:${item.diff>0?'var(--ios-red)':'var(--ios-green)'}">${fmt(item.diff)}</span>
            </div>`;
        });
    }

    // æ¡£æ¡ˆä¸æ˜ç»†ç®¡ç†
    async function showDetail(n, k, t1, t2) {
        document.getElementById('sheet').style.display='block';
        document.getElementById('sheet-head').innerHTML = `<h2 style="margin:0">${n}</h2>
            <button class="btn-danger" onclick="delEntity('${n}','${k}','${t1}','${t2}')">åˆ é™¤æ­¤å•ä½æ¡£æ¡ˆ</button>
            <button class="btn btn-p" onclick="qRec('${n}','${k}','${t2}')">ç™»è®°è´¦å•/æ”¯ä»˜</button>
            <button class="btn btn-s" onclick="mInv('${n}','${k}','t1')">å½•å…¥å‘ç¥¨/è°ƒè´¦</button>`;
        const {data:d1} = await sb.from(t1).select('*').eq(k,n); const {data:d2} = await sb.from(t2).select('*').eq(k,n);
        const all = [...(d1||[]).map(x=>({...x,t:'å•æ®'})),...(d2||[]).map(x=>({...x,t:'æ¬¾é¡¹'}))].sort((a,b)=>new Date(b.inv_date||b.pay_date)-new Date(a.inv_date||a.pay_date));
        document.getElementById('sheet-body').innerHTML = all.map(i=>`<div class="ios-item"><div><small style="color:#999">${i.inv_date||i.pay_date}</small><br><b>${i.t}</b></div><div style="text-align:right"><b>${fmt(i.amount)}</b><br><small style="color:red" onclick="delRec('${i.id}','${i.t==='å•æ®'?t1:t2}')">åˆ é™¤</small></div></div>`).join('');
    }

    async function showWDetail(n, r) {
        document.getElementById('sheet').style.display='block';
        document.getElementById('sheet-head').innerHTML = `<h2>${n}</h2><p style="font-size:12px;color:#999">é»˜è®¤æ—¶è–ª: Â¥${r}/h</p>
            <button class="btn-danger" onclick="delW('${n}')">æ³¨é”€å·¥äººæ¡£æ¡ˆ</button>
            <button class="btn btn-p" onclick="logW('${n}',${r},'å·¥æ—¶')">è®°å·¥æ—¶</button>
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px;">
                <button class="btn btn-s" onclick="logW('${n}',0,'å¥–é‡‘')">å¥–é‡‘</button>
                <button class="btn btn-s" onclick="logW('${n}',0,'åˆ†çº¢')">åˆ†çº¢</button>
                <button class="btn btn-s" onclick="logW('${n}',0,'å‘å·¥èµ„')">å‘è–ª</button>
            </div>`;
        const {data} = await sb.from('wage_logs').select('*').eq('worker_name', n).order('log_date',{ascending:false});
        document.getElementById('sheet-body').innerHTML = (data||[]).map(l=>`<div class="ios-item"><div><small style="color:#999">${l.log_date}</small><br><b>${l.type}</b> ${l.work_hours?l.work_hours+'h':''}</div><div style="text-align:right"><b>${fmt(l.amount)}</b><br><small style="color:red" onclick="delRec('${l.id}','wage_logs')">åˆ é™¤</small></div></div>`).join('');
    }

    // è¾…åŠ©åŠŸèƒ½
    async function addEntity(k, t) { const n = prompt("åç§°:"); if(n) { await sb.from(t).insert({ [k]:n, amount:0, inv_date:new Date().toISOString().split('T')[0] }); load(); }}
    async function addW() { const n = prompt("å§“å:"); const r = prompt("æ—¶è–ª:", 20); if(n) { await sb.from('workers').insert({ name:n, hourly_rate:r }); load(); }}
    async function delEntity(n, k, t1, t2) { if(confirm("åˆ é™¤æ¡£æ¡ˆï¼Ÿ")) { await sb.from(t1).delete().eq(k,n); await sb.from(t2).delete().eq(k,n); load(); document.getElementById('sheet').style.display='none'; }}
    async function delW(n) { if(confirm("æ³¨é”€æ¡£æ¡ˆï¼Ÿ")) { await sb.from('workers').delete().eq('name',n); await sb.from('wage_logs').delete().eq('worker_name',n); load(); document.getElementById('sheet').style.display='none'; }}
    async function delRec(id,t){ if(confirm("ç¡®å®šåˆ é™¤ï¼Ÿ")){ await sb.from(t).delete().eq('id',id); load(); document.getElementById('sheet').style.display='none'; }}
    async function qRec(n,k,t){ const a=prompt("é‡‘é¢:"); if(a) await sb.from(t).insert({[k]:n,amount:parseFloat(a),pay_date:new Date().toISOString().split('T')[0]}); load(); document.getElementById('sheet').style.display='none'; }
    async function logW(n,r,type){ let a=0,h=0; if(type==='å·¥æ—¶'){ h=prompt("å°æ—¶:"); a=h*r; }else{ a=prompt("é‡‘é¢:"); } if(a) await sb.from('wage_logs').insert({worker_name:n,amount:parseFloat(a),type,work_hours:h||null,log_date:new Date().toISOString().split('T')[0]}); load(); document.getElementById('sheet').style.display='none'; }
    function tab(id, el) { document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); document.querySelectorAll('.nav-link').forEach(b=>b.classList.remove('active')); document.getElementById(id).classList.add('active'); el.classList.add('active'); }
    async function handleExcel(i){ const f=i.files[0]; if(!f)return; const r=new FileReader(); r.onload=async(e)=>{ const wb=XLSX.read(new Uint8Array(e.target.result),{type:'array'}); const json=XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]); const upI=[],upVI=[]; json.forEach(r=>{ const item={invoice_num:String(r['æ•°ç”µå‘ç¥¨å·ç ']||''),amount:parseFloat(r['ä»·ç¨åˆè®¡']||0),inv_date:String(r['å¼€ç¥¨æ—¥æœŸ']||'')}; if(String(r['é”€æ–¹åç§°']).includes('æ’ä¸°')){item.client_name=r['è´­ä¹°æ–¹åç§°'];upI.push(item);}else{item.vendor_name=r['é”€æ–¹åç§°'];upVI.push(item);}}); await sb.from('invoices').upsert(upI,{onConflict:'invoice_num'}); await sb.from('vendor_invoices').upsert(upVI,{onConflict:'invoice_num'}); alert("å¯¼å…¥æˆåŠŸ"); load();}; r.readAsArrayBuffer(f); }
</script>
</body>
</html>
